---
section: "data cleaning"
title: "other.csv notebook"
---
# 2.1 Data Cleaning

##### Description

Basic data visualization and data formatting.

##### Notebook Steps

1. Input Data
1. Examine Data
1. Data Cleaning
1. Output Data

## 1. Input Data

##### Required Imports


```python
import pandas as pd
```

##### Code


```python
ref = '../../data/1-data_acquisition/1-output.csv.zip' # output file from step 1

df = pd.read_csv(ref, low_memory=False) # read into dataframe
```

## 2. Examine Data

##### shape


```python
df.shape
```




    (510125, 20)



##### info()


```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 510125 entries, 0 to 510124
    Data columns (total 20 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   image               510125 non-null  int64  
     1   newacct_no          510125 non-null  object 
     2   line_stat           510125 non-null  object 
     3   bill_cycl           510125 non-null  int64  
     4   serv_type           510125 non-null  object 
     5   serv_code           510125 non-null  object 
     6   tenure              510125 non-null  int64  
     7   effc_strt_date      508188 non-null  object 
     8   effc_end_date       508188 non-null  object 
     9   contract_month      508188 non-null  float64
     10  ce_expiry           508188 non-null  float64
     11  secured_revenue     510125 non-null  float64
     12  bandwidth           510125 non-null  object 
     13  term_reas_code      5523 non-null    object 
     14  term_reas_desc      5523 non-null    object 
     15  complaint_cnt       510125 non-null  object 
     16  with_phone_service  510125 non-null  object 
     17  churn               510125 non-null  object 
     18  current_mth_churn   510125 non-null  object 
     19  Unnamed: 19         2 non-null       object 
    dtypes: float64(3), int64(3), object(14)
    memory usage: 77.8+ MB
    

##### describe()


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>image</th>
      <th>bill_cycl</th>
      <th>tenure</th>
      <th>contract_month</th>
      <th>ce_expiry</th>
      <th>secured_revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>510125.000000</td>
      <td>510125.0</td>
      <td>510125.000000</td>
      <td>508188.000000</td>
      <td>508188.000000</td>
      <td>510125.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>201857.993237</td>
      <td>1.0</td>
      <td>60.700254</td>
      <td>24.916928</td>
      <td>7.390413</td>
      <td>504.573587</td>
    </tr>
    <tr>
      <th>std</th>
      <td>50.076142</td>
      <td>0.0</td>
      <td>51.213282</td>
      <td>5.245176</td>
      <td>13.719428</td>
      <td>1492.281865</td>
    </tr>
    <tr>
      <th>min</th>
      <td>201801.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-175.000000</td>
      <td>-385.220000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>201807.000000</td>
      <td>1.0</td>
      <td>18.000000</td>
      <td>24.000000</td>
      <td>2.000000</td>
      <td>158.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>201901.000000</td>
      <td>1.0</td>
      <td>45.000000</td>
      <td>24.000000</td>
      <td>9.000000</td>
      <td>204.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>201907.000000</td>
      <td>1.0</td>
      <td>95.000000</td>
      <td>24.000000</td>
      <td>16.000000</td>
      <td>360.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>201912.000000</td>
      <td>1.0</td>
      <td>225.000000</td>
      <td>120.000000</td>
      <td>115.000000</td>
      <td>61161.290000</td>
    </tr>
  </tbody>
</table>
</div>



##### head()


```python
df.head().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>image</th>
      <td>201801</td>
      <td>201801</td>
      <td>201801</td>
      <td>201801</td>
      <td>201801</td>
    </tr>
    <tr>
      <th>newacct_no</th>
      <td>70068143.001.000000062</td>
      <td>70068143.003.000072630</td>
      <td>70071840.001.000000066</td>
      <td>70071840.003.000060034</td>
      <td>70076500.001.000000073</td>
    </tr>
    <tr>
      <th>line_stat</th>
      <td>AC</td>
      <td>AC</td>
      <td>AC</td>
      <td>AC</td>
      <td>AC</td>
    </tr>
    <tr>
      <th>bill_cycl</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>serv_type</th>
      <td>BBS</td>
      <td>BBS</td>
      <td>BBS</td>
      <td>BBS</td>
      <td>BBS</td>
    </tr>
    <tr>
      <th>serv_code</th>
      <td>VS100DUN</td>
      <td>VS030F6R</td>
      <td>EAXMXMFSRN1</td>
      <td>VS100DUN</td>
      <td>PF100FSR</td>
    </tr>
    <tr>
      <th>tenure</th>
      <td>202</td>
      <td>35</td>
      <td>202</td>
      <td>72</td>
      <td>202</td>
    </tr>
    <tr>
      <th>effc_strt_date</th>
      <td>06.03.2018 00:00:00</td>
      <td>01.03.2019 00:00:00</td>
      <td>01.10.2019 00:00:00</td>
      <td>07.11.2018 00:00:00</td>
      <td>01.05.2017 00:00:00</td>
    </tr>
    <tr>
      <th>effc_end_date</th>
      <td>05.03.2021 00:00:00</td>
      <td>28.02.2021 00:00:00</td>
      <td>30.09.2021 00:00:00</td>
      <td>06.11.2020 00:00:00</td>
      <td>30.04.2019 00:00:00</td>
    </tr>
    <tr>
      <th>contract_month</th>
      <td>36</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
    </tr>
    <tr>
      <th>ce_expiry</th>
      <td>13</td>
      <td>13</td>
      <td>20</td>
      <td>9</td>
      <td>-9</td>
    </tr>
    <tr>
      <th>secured_revenue</th>
      <td>178</td>
      <td>1572</td>
      <td>290</td>
      <td>218</td>
      <td>430</td>
    </tr>
    <tr>
      <th>bandwidth</th>
      <td>100M</td>
      <td>30M</td>
      <td>10M</td>
      <td>100M</td>
      <td>100M (FTTO)</td>
    </tr>
    <tr>
      <th>term_reas_code</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>term_reas_desc</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>complaint_cnt</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>with_phone_service</th>
      <td>N</td>
      <td>N</td>
      <td>Y</td>
      <td>Y</td>
      <td>N</td>
    </tr>
    <tr>
      <th>churn</th>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>current_mth_churn</th>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
    </tr>
    <tr>
      <th>Unnamed: 19</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



##### tail()


```python
df.tail().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>510120</th>
      <th>510121</th>
      <th>510122</th>
      <th>510123</th>
      <th>510124</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>image</th>
      <td>201912</td>
      <td>201912</td>
      <td>201912</td>
      <td>201912</td>
      <td>201912</td>
    </tr>
    <tr>
      <th>newacct_no</th>
      <td>96556659.001.000097362</td>
      <td>96561147.001.000097409</td>
      <td>96562046.001.000068616</td>
      <td>96562046.001.000082585</td>
      <td>96569066.001.000095968</td>
    </tr>
    <tr>
      <th>line_stat</th>
      <td>AC</td>
      <td>AC</td>
      <td>AC</td>
      <td>AC</td>
      <td>AC</td>
    </tr>
    <tr>
      <th>bill_cycl</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>serv_type</th>
      <td>BBS</td>
      <td>BBS</td>
      <td>BBS</td>
      <td>BBS</td>
      <td>BBS</td>
    </tr>
    <tr>
      <th>serv_code</th>
      <td>PF1000DUN</td>
      <td>VS100DUN</td>
      <td>VPXMXMDURN</td>
      <td>VS100DUSAR</td>
      <td>PF1000DUN</td>
    </tr>
    <tr>
      <th>tenure</th>
      <td>0</td>
      <td>0</td>
      <td>70</td>
      <td>34</td>
      <td>3</td>
    </tr>
    <tr>
      <th>effc_strt_date</th>
      <td>31.12.2019 00:00:00</td>
      <td>31.12.2019 00:00:00</td>
      <td>12.03.2019 00:00:00</td>
      <td>04.03.2019 00:00:00</td>
      <td>19.09.2019 00:00:00</td>
    </tr>
    <tr>
      <th>effc_end_date</th>
      <td>30.12.2021 00:00:00</td>
      <td>30.12.2021 00:00:00</td>
      <td>11.03.2021 00:00:00</td>
      <td>03.03.2021 00:00:00</td>
      <td>18.09.2021 00:00:00</td>
    </tr>
    <tr>
      <th>contract_month</th>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
    </tr>
    <tr>
      <th>ce_expiry</th>
      <td>23</td>
      <td>23</td>
      <td>13</td>
      <td>13</td>
      <td>19</td>
    </tr>
    <tr>
      <th>secured_revenue</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>bandwidth</th>
      <td>1000M (FTTO)</td>
      <td>100M</td>
      <td>10M</td>
      <td>100M</td>
      <td>1000M (FTTO)</td>
    </tr>
    <tr>
      <th>term_reas_code</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>term_reas_desc</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>complaint_cnt</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>with_phone_service</th>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
    </tr>
    <tr>
      <th>churn</th>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
    </tr>
    <tr>
      <th>current_mth_churn</th>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
    </tr>
    <tr>
      <th>Unnamed: 19</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



##### isnull()


```python
df.isnull().sum().sort_values(ascending=False)
```




    Unnamed: 19           510123
    term_reas_code        504602
    term_reas_desc        504602
    effc_strt_date          1937
    effc_end_date           1937
    ce_expiry               1937
    contract_month          1937
    bandwidth                  0
    secured_revenue            0
    complaint_cnt              0
    current_mth_churn          0
    with_phone_service         0
    churn                      0
    tenure                     0
    serv_code                  0
    serv_type                  0
    bill_cycl                  0
    line_stat                  0
    newacct_no                 0
    image                      0
    dtype: int64



#### nunique()


```python
df.nunique().sort_values()
```




    Unnamed: 19               1
    bill_cycl                 1
    serv_type                 1
    churn                     2
    current_mth_churn         2
    line_stat                 3
    with_phone_service        3
    complaint_cnt             9
    bandwidth                 9
    image                    24
    term_reas_code           26
    term_reas_desc           26
    contract_month           56
    ce_expiry               180
    tenure                  226
    serv_code               288
    effc_strt_date         2085
    effc_end_date          2348
    secured_revenue       10344
    newacct_no            27605
    dtype: int64




```python
columns = df.columns

values = df.nunique().sort_values()

print('--------------------------------------')

for column in columns:
    if(values[column] < 10):
        print(df[column].value_counts())
        print('--------------------------------------')
```

    --------------------------------------
    AC    494338
    IS     10284
    CN      5503
    Name: line_stat, dtype: int64
    --------------------------------------
    1    510125
    Name: bill_cycl, dtype: int64
    --------------------------------------
    BBS    510125
    Name: serv_type, dtype: int64
    --------------------------------------
    100M            256952
    100M (FTTO)      92217
    10M              61711
    30M              52688
    1000M (FTTO)     26066
    300M (FTTO)      11160
    500M (FTTO)       4026
    BELOW 10M         2772
    50M               2533
    Name: bandwidth, dtype: int64
    --------------------------------------
    0                            498081
    1                             10093
    2                              1494
    3                               288
    4                                93
    5                                40
    6                                18
    7                                15
     customer/ user pass away         3
    Name: complaint_cnt, dtype: int64
    --------------------------------------
    N    309580
    Y    200542
    0         3
    Name: with_phone_service, dtype: int64
    --------------------------------------
    N    441526
    Y     68599
    Name: churn, dtype: int64
    --------------------------------------
    N    504622
    Y      5503
    Name: current_mth_churn, dtype: int64
    --------------------------------------
    Y    2
    Name: Unnamed: 19, dtype: int64
    --------------------------------------
    

## 3. Data Cleaning

##### Null Value Cleanup
<p>The <b>Unnamed: 19</b> column will be dropped.</p>
<p>The <b>term_reas_code</b> and <b>term_reas_desc</b> have a high number of null values. These columns will be dropped.</p>
<p>The <b>effc_strt_date, effc_end_date, contract_month</b> and <b>ce_expiry</b> columns have a low number of null values with no discernible way to fill them in. The rows can be dropped without much data loss.</p>

##### Dropping Unnecessary Columns

<p> The <b>bill_cycl</b> and <b>serv_type</b> columns will be dropped because they each have only one unique value, therefore they are useless for modeling.</p>

##### Type Formatting
<p>The <b>image</b> column must be formatted to a proper datetime.</p>
<p>The <b>bandwidth</b> column must be refactored to a categorical.</p>
<p>The <b>effc_strt_date</b> and <b>effc_end_date</b> columns must be converted to datetimes.</p>
<p>The <b>contract_month, ce_expiry</b> and <b>secured_revenue</b> columns must be converted to integers.</p>
<p>The <b>with_phone_service, churn</b> and <b>current_mth_churn</b> columns must be converted to booleans.</p>
    
##### Column Renaming
<p>This step is optional. Just making the columns easier to read in a dataframe.</p>

### Null Value Cleanup

##### Unnamed: 19


```python
df = df.drop('Unnamed: 19', axis=1)
```

##### term_reas_code and term_reas_desc


```python
columns = ['term_reas_code', 'term_reas_desc']
df = df.drop(columns, axis=1)
```

##### effc_strt_date, effc_end_date, contract_month and ce_expiry


```python
df = df.dropna()
df = df.reset_index(drop=True)
```

### Dropping Unnecessary Columns


```python
columns = ['bill_cycl', 'serv_type']
df = df.drop(columns, axis=1)
```

### Type Formatting

##### image


```python

```

##### bandwidth


```python

```

##### effc_strt_date and effc_end_date


```python

```

##### contract_month, ce_expiry and secured_revenue


```python
columns = ['contract_month', 'ce_expiry', 'secured_revenue']

df[columns] = df[columns].astype('int64')
```

##### with_phone_service, churn and current_mth_churn


```python

```

### Column Renaming


```python
columns = {
    'newacct_no': 'account_number',
    'line_stat': 'line_state',
    'serv_code': 'service_code',
    'effc_strt_date': 'contract_start',
    'effc_end_date' : 'contract_end',
    'complaint_cnt': 'complaint_count',
    'current_mth_churn': 'current_month_churn'
}

df = df.rename(columns=columns)
```

## Output Data


```python
# Output file location
ref = '../../data/2-data_cleaning/2-output.csv.zip'

# Compression options
compression_opts = dict(method='zip',
                        archive_name='2-output.csv')  
# Output data to zipped csv
df.to_csv(ref, index=False,
          compression=compression_opts)
```


```python

```
